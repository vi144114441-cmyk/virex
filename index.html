<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L√¨ X√¨ 3D B√≠nh Ng·ªç 2026</title>

<style>
*{box-sizing:border-box;}
body{
    margin:0;
    font-family:Arial, sans-serif;
    text-align:center;
    color:white;
    overflow-x:hidden;
    background: linear-gradient(135deg,#8B0000,#ff0000,#b71c1c);
}

/* PH√ÅO HOA */
.rocket{
    position:fixed;
    width:4px;height:12px;
    background:gold;
    border-radius:2px;
    box-shadow:0 0 10px gold;
    pointer-events:none;
}
.firework{
    position:fixed;
    width:6px;height:6px;
    border-radius:50%;
    pointer-events:none;
    animation:explode 1.2s ease-out forwards;
    box-shadow:0 0 12px currentColor;
}
@keyframes explode{
    from{transform:translate(0,0);opacity:1;}
    to{transform:translate(var(--x),var(--y));opacity:0;}
}

/* NH·∫¨P T√äN */
.welcome-screen{
    position:fixed;inset:0;
    background:linear-gradient(#8B0000,#a00000);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    z-index:9999;
}
.welcome-screen input{
    padding:14px;
    font-size:18px;
    border-radius:15px;
    border:none;
    width:90%;max-width:300px;
    text-align:center;
    margin-top:20px;
}
.welcome-screen button{
    margin-top:20px;
    padding:14px 32px;
    border:none;
    border-radius:18px;
    background:gold;
    color:#8B0000;
    font-weight:bold;
}

/* MAIN */
.main-content{display:none;padding:30px 15px;}
.container{
    display:grid;
    gap:20px;
    margin:30px auto 0;
    width:100%;
    max-width:1200px;
    grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
}

/* L√å X√å */
.lixi{display:flex;justify-content:center;perspective:1000px;}
.card{
    width:100%;max-width:150px;
    aspect-ratio:1/2;
    position:relative;
    transform-style:preserve-3d;
    cursor:pointer;
}
.front{
    position:absolute;
    width:100%;height:100%;
    border-radius:18px;
    background:#b71c1c;
}
.flap{
    position:absolute;
    top:0;width:100%;height:50%;
    background:linear-gradient(#d32f2f,#aa0000);
    clip-path:polygon(0 0,100% 0,50% 100%);
    transform-origin:top;
    transition:transform 0.8s;
}
.back{
    position:absolute;
    width:80%;height:60%;
    top:25%;left:10%;
    background:white;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:10px;
    font-weight:bold;
    color:#8B0000;
    transform:translateY(60px);
    opacity:0;
    transition:all 0.8s;
}
.lixi.open .flap{transform:rotateX(-150deg);}
.lixi.open .back{transform:translateY(-30px);opacity:1;}

.overlay{
    position:fixed;inset:0;
    background:#8B0000;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    z-index:9999;
}
.overlay input{
    padding:14px;
    font-size:18px;
    border-radius:15px;
    border:none;
    width:90%;max-width:300px;
    text-align:center;
    margin-top:15px;
}
.overlay button{
    margin-top:15px;
    padding:12px 28px;
    border-radius:15px;
    border:none;
}
</style>
</head>

<body>

<div class="welcome-screen" id="welcome">
    <h1>üéâ CH√öC M·ª™NG NƒÇM M·ªöI 2026 üéâ</h1>
    <input id="playerNameStart" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n">
    <button onclick="enterApp()">Nh·∫≠n L√¨ X√¨ üßß</button>
</div>

<div class="main-content" id="main">
    <h2>üßß L√å X√å MAY M·∫ÆN - B√çNH NG·ªå 2026 üßß</h2>
    <div id="countdown" style="margin-top:10px;font-size:18px;color:gold;"></div>
    <div class="container" id="container"></div>
</div>

<audio id="bgMusic" src="nhactet.mp3" loop></audio>

<script>

const WEBAPP_URL="https://script.google.com/macros/s/AKfycbz58kCVNFXfj-8sDwM2qaNu_Wvcu9908looXkHtNnPxbN0L85mwVNl0O8Mjn3xfOLnZ4g/exec";

let playerName="";
let started=false;

/* G·ª¨I GOOGLE SHEETS */
function sendToSheet(name,reward){
    fetch(WEBAPP_URL,{
        method:"POST",
        body:JSON.stringify({
            name:name,
            reward:reward,
            time:new Date().toLocaleString()
        })
    });
}

function getToday(){
    let now=new Date();
    return now.getFullYear()+"-"+String(now.getMonth()+1).padStart(2,'0')+"-"+String(now.getDate()).padStart(2,'0');
}

/* V√ÄO APP */
function enterApp(){
    let name=document.getElementById("playerNameStart").value.trim();
    if(!name){ alert("Vui l√≤ng nh·∫≠p t√™n!"); return; }

    playerName=name;
    document.getElementById("welcome").style.display="none";
    document.getElementById("main").style.display="block";
    started=true;
    updateCountdown();
}

/* NH·∫†C */
function playMusic(){
    document.getElementById("bgMusic").play().catch(()=>{});
}

/* ƒê·ªíNG H·ªí RESET */
function updateCountdown(){
    const now=new Date();
    const tomorrow=new Date();
    tomorrow.setHours(24,0,0,0);
    const diff=tomorrow-now;

    if(diff<=0){
        localStorage.removeItem("openedDate");
        location.reload();
    }

    const h=Math.floor(diff/1000/60/60);
    const m=Math.floor(diff/1000/60%60);
    const s=Math.floor(diff/1000%60);

    document.getElementById("countdown").innerText=
    "‚è≥ Reset sau: "+h+"h "+m+"m "+s+"s";
}
setInterval(updateCountdown,1000);

/* PH√ÅO HOA */
function launchRocket(x){
    let rocket=document.createElement("div");
    rocket.className="rocket";
    rocket.style.left=x+"px";
    rocket.style.bottom="0px";
    document.body.appendChild(rocket);

    let height=Math.random()*window.innerHeight*0.5+150;
    let pos=0;

    let fly=setInterval(()=>{
        pos+=8;
        rocket.style.bottom=pos+"px";
        if(pos>=height){
            clearInterval(fly);
            rocket.remove();
            explodeHeart(x,window.innerHeight-height);
        }
    },16);
}

function explodeHeart(x,y){
    const particles=120;
    const scale=10;
    for(let i=0;i<particles;i++){
        const t=(i/particles)*Math.PI*2;
        const heartX=16*Math.pow(Math.sin(t),3);
        const heartY=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
        let fw=document.createElement("div");
        fw.className="firework";
        fw.style.left=x+"px";
        fw.style.top=y+"px";
        fw.style.color=i%2===0?"gold":"#ff0044";
        fw.style.background="currentColor";
        fw.style.setProperty("--x",heartX*scale+"px");
        fw.style.setProperty("--y",-heartY*scale+"px");
        document.body.appendChild(fw);
        setTimeout(()=>fw.remove(),1200);
    }
}

setInterval(()=>{ if(started) launchRocket(Math.random()*window.innerWidth); },3000);
document.addEventListener("click",(e)=>{ if(started) launchRocket(e.clientX); });

/* T·∫†O 25 BAO */
const container=document.getElementById("container");
for(let i=0;i<25;i++){
    let w=document.createElement("div");
    w.className="lixi";
    w.innerHTML=`
        <div class="card">
            <div class="front"></div>
            <div class="flap"></div>
            <div class="back"></div>
        </div>`;
    w.onclick=()=>openCard(w);
    container.appendChild(w);
}

function openCard(wrapper){
    if(wrapper.classList.contains("open")) return;

    if(localStorage.getItem("openedDate")===getToday()){
        showPassword();
        return;
    }

    let back=wrapper.querySelector(".back");
    let random=Math.random()*100;
    let reward="";

    if(random<50){
        let amount=Math.floor(Math.random()*48+2)*2000;
        reward="üí∞ "+amount.toLocaleString("vi-VN")+" VNƒê";
    }else{
        reward="üéâ Ch√∫c "+playerName+" nƒÉm m·ªõi ph√°t t√†i!";
    }

    back.innerText=reward;
    wrapper.classList.add("open");
    localStorage.setItem("openedDate",getToday());

    playMusic();
    sendToSheet(playerName,reward);

    setTimeout(()=>{
        alert("üéâ "+playerName+" nh·∫≠n ƒë∆∞·ª£c:\n"+reward);
    },800);
}

function showPassword(){
    let overlay=document.createElement("div");
    overlay.className="overlay";
    overlay.innerHTML=`
        <h2>üîí Nh·∫≠p m·∫≠t kh·∫©u m·ªü l·∫°i</h2>
        <input type="password" id="passInput">
        <button onclick="checkPass()">X√°c nh·∫≠n</button>
    `;
    document.body.appendChild(overlay);

    window.checkPass=function(){
        if(document.getElementById("passInput").value==="LAMGICOLANHAI"){
            localStorage.removeItem("openedDate");
            overlay.remove();
            alert("M·ªü l·∫°i th√†nh c√¥ng!");
        }else{
            alert("Sai m·∫≠t kh·∫©u!");
        }
    }
}
</script>
</body>
</html>
